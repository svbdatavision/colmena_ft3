# Reorganización de variables por tipo - VERSIÓN CORREGIDA CON NOMBRES EXACTOS

# LLAVES (Keys) - Identificadores únicos
llaves = [
    'AFILIADO_RUT',
    'LCC_COMCOR',
    'LCC_COMCOD',
    'N_LICENCIA',
    'PRESTADOR_RUT',
    'PRESTADOR_LOCAL_RUT',
    'EMPLEADOR_RUT'
]

# FECHAS (Dates)
fechas = [
    'FECHA_EMP_RECEPCION',
    'FECHA_EMP_ENVIO',
    'FECHA_NAC_HIJO',
    'FECHA_EMISION_DT',
    'FECHA_RECEPCION',
    'FECHA_INICIO',
    'FECHA_TERMINO',
    'EPISODIO_FEC_INI'
]

# CATEGÓRICAS (Categorical)
categoricas = [
    'COT_GENERO',
    'CIE_F',
    'CIE_F_COD',
    'CIE_GRUPO',
    'LM_FORMATO',
    'LM_REPOSO_TIPO',
    'TIPO_F_LM',
    'TIPO_F_LM_COD',
    'I_TIPOLIC',
    'PRESTADOR_ESPECIALIDAD_PSC',
    'PRESTADOR_TIPO',
    'MED_ESPECIALIDAD_LME',
    'MED_CLASIFICACION',
    'PREST_TOP_CIE_F',
    'PREST_TOP_GRUPOCIE',
    'COMUNA_REPOSO',
    'COMUNA_EMISION',
    'EMPLEADOR_MULTIEMPLEADO',
    'CALIDAD_TRABAJADOR',
    'CONTINUA_CALC',
    'COMPIN_CNT'
]

# NUMÉRICAS (Numeric)
numericas = [
    'DIAS_RECEPCION_A_EMPLEADOR',
    'DIAS_RECEPCION_A_ENVIO',
    'DIAS_INICIO_A_RECEPCION',
    'DIAS_INICIO_A_EMISION',
    'DIAS_EMISION_A_RECEPCION',
    'ENVIO_TARDIO_EMPLEADOR',
    'DIASSOLICITADO',
    'COT_EDAD',
    'DEUDA_SIN_I',
    'DEUDA_SIN_I_ULT12M',
    'MESES_DESDE_CONTRATO',
    'MESES_ANTIGUEDAD_PRESTADOR',
    'EMPLEADOS_CON_LM',
    'RENTA_ESTIMADA',
    'EPISODIO_ACUM_DIAS',
    'RN',
    'CANT_LIC_U1M_CALC',
    'CANT_LIC_U6M_CALC',
    'CANT_LIC_U12M_CALC',
    'CANT_LIC_U24M_CALC',
    'CANT_LIC_U36M_CALC',
    'COMPIN_RATIFICA_01',
    'COMPIN_RATIFICA_06',
    'COMPIN_RATIFICA_12',
    'COMPIN_RATIFICA_24',
    'M_DIASAUTORIZADOS_TOTAL_U1M',
    'M_DIASAUTORIZADOS_PROMEDIO_U1M',
    'M_DIASAUTORIZADOS_MAXIMO_U1M',
    'M_DIASAUTORIZADOS_TOTAL_U6M',
    'M_DIASAUTORIZADOS_PROMEDIO_U12M',
    'M_DIASAUTORIZADOS_MAXIMO_U12M',
    'M_DIASAUTORIZADOS_TOTAL_U12M',
    'M_DIASAUTORIZADOS_PROMEDIO_U24M',
    'M_DIASAUTORIZADOS_MAXIMO_U24M',
    'F_DIAS_PROMEDIO_U1M',
    'F_DIAS_MINIMO_U6M',
    'F_DIAS_MINIMO_U12M',
    'F_DIAS_MINIMO_U24M',
    'F_DIAS_PROMEDIO_U6M',
    'F_DIAS_PROMEDIO_U12M',
    'F_DIAS_PROMEDIO_U24M',
    'F_DIAS_PROMEDIO_U36M',
    'F_DIAS_MAXIMO_U6M',
    'DIFF_DIAS_PERDIDOS_RESOL_MINIMO_U6M',
    'DIFF_DIAS_PERDIDOS_RESOL_PROMEDIO_U6M',
    'DIFF_DIAS_PERDIDOS_RESOL_MAXIMO_U6M',
    'DIFF_DIAS_PERDIDOS_RESOL_PROMEDIO_U12M',
    'DIFF_DIAS_PERDIDOS_RESOL_PROMEDIO_U24M',
    'DIFF_DIAS_PERDIDOS_RESOL_PROMEDIO_U36M',
    'DIASSOLICITADO_TOTAL_U1M',
    'DIASSOLICITADO_PROMEDIO_U1M',
    'DIASSOLICITADO_MAXIMO_U1M',
    'DIASSOLICITADO_TOTAL_U6M',
    'DIASSOLICITADO_PROMEDIO_U6M',
    'DIASSOLICITADO_MAXIMO_U6M',
    'DIASSOLICITADO_TOTAL_U12M',
    'DIASSOLICITADO_PROMEDIO_U12M',
    'DIASSOLICITADO_MAXIMO_U12M',
    'DIASSOLICITADO_TOTAL_U24M',
    'DIASSOLICITADO_PROMEDIO_U24M',
    'DIASSOLICITADO_TOTAL_U36M',
    'TIEMPO_PROMEDIO_RESOLUCION_COMPIN_01',
    'TIEMPO_PROMEDIO_RESOLUCION_COMPIN_06',
    'TIEMPO_PROMEDIO_RESOLUCION_COMPIN_12',
    'TIEMPO_PROMEDIO_RESOLUCION_COMPIN_24',
    'TIEMPO_PROMEDIO_RESOLUCION_COMPIN_36',
    'PORCENTAJE_LM_MODIFICADA_01',
    'PORCENTAJE_LM_MODIFICADA_06',
    'PORCENTAJE_LM_MODIFICADA_12',
    'PORCENTAJE_LM_MODIFICADA_24',
    'PORCENTAJE_LM_MODIFICADA_36',
    'LM_MODIFICADA_01',
    'LM_MODIFICADA_06',
    'LM_MODIFICADA_12',
    'LM_MODIFICADA_24',
    'LM_MODIFICADA_36',
    'LM_DENEGADAS_COMPIN_01',
    'LM_DENEGADAS_COMPIN_06',
    'LM_DENEGADAS_COMPIN_12',
    'LM_DENEGADAS_COMPIN_36',
    'LM_TIPO_ENF_COMUN_12',
    'LM_TIPO_ENF_COMUN_24',
    'LM_TIPO_ENF_COMUN_36',
    'LM_CON_PERITAJE_12',
    'CTD_ENVIA_PERITAJE_PROMEDIO_U12M',
    'CTD_ENVIA_INFORME_MEDICO_PROMEDIO_U12M',
    'CTD_ENVIA_PERITAJE_U12M',
    'SIN_SUBSIDIO_01',
    'SIN_SUBSIDIO_12',
    'SIN_SUBSIDIO_24',
    'MEDICO_LM_RECHAZADAS_ISAPRE_U1M',
    'MEDICO_LM_RECHAZADAS_ISAPRE_U6M',
    'MEDICO_LM_RECHAZADAS_ISAPRE_U12M',
    'MEDICO_LM_RECHAZADAS_ISAPRE_U24M',
    'MEDICO_LM_RECHAZADAS_ISAPRE_U36M',
    'MEDICO_LM_RECIBIDAS_TOTAL_U1M',
    'MEDICO_LM_RECIBIDAS_TOTAL_U6M',
    'MEDICO_LM_RECIBIDAS_TOTAL_U12M',
    'MEDICO_LM_RECIBIDAS_TOTAL_U24M',
    'MEDICO_LM_RECIBIDAS_TOTAL_U36M',
    'MEDICO_DIAS_MODIFICADOS_SUM_ISAPRE_U1M',
    'MEDICO_DIAS_MODIFICADOS_SUM_ISAPRE_U6M',
    'MEDICO_DIAS_MODIFICADOS_SUM_ISAPRE_U12M',
    'MEDICO_DIAS_MODIFICADOS_SUM_ISAPRE_U24M',
    'MEDICO_DIAS_MODIFICADOS_SUM_ISAPRE_U36M',
    'MEDICO_DIAS_MODIFICADOS_PCT_ISAPRE_U1M',
    'MEDICO_DIAS_MODIFICADOS_PCT_ISAPRE_U6M',
    'MEDICO_DIAS_MODIFICADOS_PCT_ISAPRE_U12M',
    'MEDICO_DIAS_MODIFICADOS_PCT_ISAPRE_U24M',
    'MEDICO_DIAS_MODIFICADOS_PCT_ISAPRE_U36M',
    'MEDICO_TASA_RATIFICACION_COMPIN_U6M',
    'MEDICO_TASA_RATIFICACION_COMPIN_U12M',
    'MEDICO_TASA_RATIFICACION_COMPIN_U24M',
    'MEDICO_TASA_RATIFICACION_COMPIN_U36M',
    'PL_LM_RECHAZADAS_ISAPRE_U1M',
    'PL_LM_RECHAZADAS_ISAPRE_U6M',
    'PL_LM_RECHAZADAS_ISAPRE_U12M',
    'PL_LM_RECHAZADAS_ISAPRE_U24M',
    'PL_LM_RECHAZADAS_ISAPRE_U36M',
    'PL_LM_RECIBIDAS_TOTAL_U1M',
    'PL_LM_RECIBIDAS_TOTAL_U6M',
    'PL_LM_RECIBIDAS_TOTAL_U12M',
    'PL_LM_RECIBIDAS_TOTAL_U24M',
    'PL_LM_RECIBIDAS_TOTAL_U36M',
    'EMPLEADOR_TASA_RECHAZO_ISAPRE_U1M',
    'EMPLEADOR_TASA_RECHAZO_ISAPRE_U6M',
    'EMPLEADOR_TASA_RECHAZO_ISAPRE_U12M',
    'EMPLEADOR_TASA_RECHAZO_ISAPRE_U36M',
    'EMPLEADOR_DIAS_SOLICITADOS_LM_U1M',
    'EMPLEADOR_DIAS_SOLICITADOS_LM_U6M',
    'EMPLEADOR_DIAS_SOLICITADOS_LM_U12M',
    'EMPLEADOR_DIAS_SOLICITADOS_LM_U36M',
    'EMPLEADOR_TASA_MODIFICACION_DIAS_ISAPRE_U1M',
    'EMPLEADOR_TASA_MODIFICACION_DIAS_ISAPRE_U6M',
    'EMPLEADOR_TASA_MODIFICACION_DIAS_ISAPRE_U12M',
    'EMPLEADOR_TASA_MODIFICACION_DIAS_ISAPRE_U36M',
    'HIST_HV_N_PRESTACIONES_U6M',
    'HIST_HV_N_MEDICOS_U6M',
    'HIST_HV_SUM_CANTIDAD_PREST_U6M',
    'HIST_HV_N_HOSP_U6M',
    'HIST_HV_N_CONSULTAS_AMB_U6M',
    'HIST_HV_DIAS_CAMA_U6M',
    'HIST_HV_FLAG_GES_U6M',
    'HIST_HV_FLAG_CAEC_U6M',
    'HIST_HV_BONIFICADO_U6M',
    'HIST_HV_N_PRESTACIONES_U12M',
    'HIST_HV_DIAS_CAMA_U12M',
    'HIST_HV_FLAG_GES_U12M',
    'HIST_HV_CONSULTAS_MISMO_MEDICO_U1M',
    'HIST_HV_CONSULTAS_MISMO_MEDICO_U3M',
    'HIST_HV_CONSULTAS_MISMO_MEDICO_U6M',
    'HIST_HV_TUVO_CONSULTA_MISMO_MEDICO_U12M',
    'HIST_HV_EXAMENES_LAB_MISMO_MEDICO_U7D',
    'HIST_HV_EXAMENES_LAB_MISMO_MEDICO_U14D',
    'HIST_HV_EXAMENES_LAB_MISMO_MEDICO_U30D',
    'HIST_HV_TUVO_EXAMENES_LAB_MISMO_MEDICO',
    'HIST_PERITAJES_NO_ASISTE_U6M',
    'HIST_PERITAJES_DESACUERDO_ISAPRE_U12M',
    'HIST_TOTAL_PERITAJES_U12M',
    'HIST_PERITAJES_ISAPRE_GANO_U6M',
    'HIST_DIAS_DESDE_ULTIMO_PERITAJE',
    'HIST_PERITAJES_DESACUERDO_ISAPRE_MEDICO_U12M',
    'HIST_PERITAJE_FAVORABLE_ISAPRE_MISMO_CIE_U3M',
    'CTD_SOLICITUDES_INFO_U30D',
    'CTD_SOLICITUDES_INFO_MEDICA_U30D',
    'CTD_SOLICITUDES_INFO_U90D',
    'CTD_SOLICITUDES_INFO_U365D',
    'CTD_PERITAJES_TOTAL_U30D',
    'CTD_PERITAJES_PSIQ_U30D',
    'CTD_PERITAJES_TOTAL_U90D',
    'DIAS_DESDE_ULTIMO_PERITAJE',
    'CTD_RECURSOS_TOTAL_U90D',
    'TASA_EXITO_RECURSOS_U90D',
    'CTD_FADE_TOTAL_U30D',
    'CTD_ACCIONES_TOTAL_U30D',
    'CTD_ACCIONES_TOTAL_U90D',
    'CTD_ACCIONES_TOTAL_U365D',
    'VELOCIDAD_ACCIONES_U30D',
    # Variables de 15 días (_U15D)
    'CANT_LIC_U15D',
    'CANT_LIC_CON_RESOLUCION_U15D',
    'COMPIN_RATIFICA_U15D',
    'COMPIN_DENIEGA_U15D',
    'F_DIAS_PROMEDIO_U15D',
    'TOTAL_DIAS_SOLICITADOS_U15D',
    'MAX_DIAS_SOLICITADOS_U15D',
    'FLAG_MULTIPLES_LIC_U15D',
    'RATIO_APROBACION_U15D',
    'HV_N_PRESTACIONES_U15D',
    'HV_SUM_CANTIDAD_PREST_U15D',
    'HV_N_MEDICOS_U15D',
    'HV_FLAG_HOSPITALARIO_U15D',
    'HV_FLAG_BONO_U15D',
    'HV_FLAG_REEMBOLSO_U15D',
    'HV_FLAG_GES_U15D',
    'HV_FLAG_CAEC_U15D',
    'PERITAJES_TOTAL_U15D',
    'PERITAJES_NO_ASISTE_U15D',
    'PERITAJES_DESACUERDO_U15D',
    'PERITAJES_ACUERDO_U15D',
    'DIAS_DESDE_ULTIMO_PERITAJE_U15D',
    'FLAG_PERITAJE_RECIENTE_U15D'
]

# BINARIAS (Binary - valores 0/1)
binarias = [
    'MEDICO_EXTRANJERO',
    'IS_MEDICO',
    'FADE_AFILIADO_90D',
    'FADE_AFILIADO_365D',
    'FADE_EMPRESA_90D',
    'FADE_EMPRESA_365D',
    'FADE_PRESTADOR_90D',
    'FADE_PRESTADOR_365D',
    'FADE_LICENCIA_7D',
    'ALERTA_AMARILLA_90D',
    'ALERTA_AMARILLA_365D',
    'ALERTA_ROJA_90D',
    'ALERTA_ROJA_365D',
    'CIE_GRUPO_PSIQUIATRICAS_01',
    'CIE_GRUPO_PSIQUIATRICAS_06',
    'CIE_GRUPO_PSIQUIATRICAS_12',
    'CIE_GRUPO_PSIQUIATRICAS_24',
    'CIE_GRUPO_PSIQUIATRICAS_36',
    'FLAG_PERITAJE_PSIQ_U30D',
    'FLAG_TIENE_FADE_U30D',
    'FLAG_SOSPECHA_FRAUDE_U90D',
    'FLAG_INFORME_MEDICO_RECEP_U30D'
]

# TEXTO NO ESTRUCTURADO
texto_no_estructurado = [
    'LM_DIAGNOSTICO',
    'LM_ANTECEDENTES_CLINICOS'
]

# TARGET (variables objetivo para entrenamiento)
target = [
    'TARGET_PERITAJE',
    'TARGET_PERITAJE2',
    'TARGET_RECHAZA',
    'TARGET_MODIFICA',
    'TARGET_FT3',
    'TARGET_RATIFICA',
    'TARGET_REQUIERE_REVISION',
    'TARGET_FT2'
]

# Verificación de conteo
total_vars = (len(llaves) + len(fechas) + len(categoricas) + len(numericas) + 
              len(binarias) + len(texto_no_estructurado) + len(target))
print(f"Total de variables clasificadas: {total_vars}")
print(f"Llaves: {len(llaves)}")
print(f"Fechas: {len(fechas)}")
print(f"Categóricas: {len(categoricas)}")
print(f"Numéricas: {len(numericas)}")
print(f"Binarias: {len(binarias)}")
print(f"Texto no estructurado: {len(texto_no_estructurado)}")
print(f"Target: {len(target)}")

# Diccionario con todos los grupos para fácil acceso
grupos_variables = {
    'llaves': llaves,
    'fechas': fechas,
    'categoricas': categoricas,
    'numericas': numericas,
    'binarias': binarias,
    'texto_no_estructurado': texto_no_estructurado,
    'target': target
}

# Verificar que todas las variables están clasificadas
from itertools import chain
todas_clasificadas = set(chain(*grupos_variables.values()))
print(f"\nTotal de variables únicas clasificadas: {len(todas_clasificadas)}")